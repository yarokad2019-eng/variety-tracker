<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>מעקב זנים | שדה</title>
<link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;500;600;700;800&family=Heebo:wght@700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="hdr">
  <div class="hdr-top">
    <div><h1><span class="ic">🌿</span>מעקב זנים מיוחדים</h1><div class="hdr-sub">תיעוד בשטח · צילום · GPS</div></div>
    <div class="hdr-btns">
      <button class="hbtn" onclick="showBackupMenu()">💾</button>
      <button class="hbtn hbtn-add" onclick="openAdd()">＋ הוסף</button>
    </div>
  </div>
  <div class="stats">
    <div class="stt"><span class="stt-n" id="sTotal">0</span><span class="stt-l">זנים</span></div>
    <div class="stt"><span class="stt-n" id="sFlow">0</span><span class="stt-l">פריחה</span></div>
    <div class="stt"><span class="stt-n" id="sSel">0</span><span class="stt-l">נבחרו</span></div>
    <div class="stt"><span class="stt-n" id="sGps">0</span><span class="stt-l">GPS</span></div>
  </div>
</div>

<div class="content">
  <div class="srch-wrap"><span class="srch-ic">🔍</span><input id="srch" type="text" placeholder="חיפוש..." oninput="renderList()"></div>
  <div class="chips">
    <button class="chip on" data-f="all" onclick="setF('all',this)">הכל 🌿</button>
    <button class="chip" data-f="ranunculus" onclick="setF('ranunculus',this)">נוריות 🌺</button>
    <button class="chip" data-f="sweetpea" onclick="setF('sweetpea',this)">Sweet Pea 🌸</button>
    <button class="chip" data-f="calendula" onclick="setF('calendula',this)">Calendula 🌼</button>
    <button class="chip" data-f="selected" onclick="setF('selected',this)">⭐ נבחרו</button>
  </div>
  <div id="list"></div>
</div>

<button class="fab" onclick="openAdd()">＋</button>

<div class="bnav">
  <div class="bni on"><div class="bni-ic">📋</div><div class="bni-lb">זנים</div></div>
  <div class="bni"><div class="bni-ic">🗺</div><div class="bni-lb">מפה</div></div>
  <div class="bni"><div class="bni-ic">📅</div><div class="bni-lb">עונה</div></div>
</div>

<div class="toast" id="toast"></div>

<!-- ADD/EDIT MODAL -->
<div class="overlay" id="addModal" onclick="bgc(event,'addModal')">
  <div class="sheet">
    <div class="sh-handle"></div>
    <div class="sh-title" id="mTitle">🌱 הוספת זן חדש</div>
    <div class="fg"><label class="fl">📷 תמונות</label><div class="cam-zone"><div class="cam-ic">📷</div><div class="cam-txt">הוסף תמונות</div><div class="cam-btns"><label class="cam-btn">📷 צלם<input type="file" accept="image/*" capture="environment" onchange="addPh(event)"></label><label class="cam-btn">🖼 גלריה<input type="file" accept="image/*" multiple onchange="addPh(event)"></label></div></div><div class="pgrid" id="pgrid"></div></div>
    <div class="divider"></div>
    <div class="fg"><label class="fl">שם הזן</label><input class="fi" id="fName" placeholder="נוריה ורודה שורה 4"></div>
    <div class="grid2">
      <div class="fg"><label class="fl">סוג</label><select class="fs" id="fType"><option value="ranunculus">נוריות 🌺</option><option value="sweetpea">Sweet Pea 🌸</option><option value="calendula">Calendula 🌼</option><option value="other">אחר 🌿</option></select></div>
      <div class="fg"><label class="fl">סטטוס</label><select class="fs" id="fStatus"><option value="flowering">🟢 פריחה</option><option value="seeding">🟡 זרעים</option><option value="dormant">⚪ רדום</option><option value="selected">🔵 נבחר</option></select></div>
    </div>
    <div class="fg"><label class="fl">📍 GPS</label><div class="gps-row"><div class="gps-lbl"><strong id="gpsLbl">לא נקלט</strong><div class="gps-acc" id="gpsAcc"></div></div><button class="gps-btn" id="gpsBtn" onclick="grabGPS()">📡 קלוט</button></div><input class="fi" id="fLoc" placeholder="מיקום: שורה 4..." style="margin-top:9px"></div>
    <div class="fg"><label class="fl">צבע</label><div class="crow"><div class="csw on" style="background:#FF6B9D" data-c="#FF6B9D" onclick="pickC(this)"></div><div class="csw" style="background:#E74C3C" data-c="#E74C3C" onclick="pickC(this)"></div><div class="csw" style="background:#FF8C42" data-c="#FF8C42" onclick="pickC(this)"></div><div class="csw" style="background:#FFD700" data-c="#FFD700" onclick="pickC(this)"></div><div class="csw" style="background:#fff;border-color:#aaa" data-c="#FFFFFF" onclick="pickC(this)"></div><div class="csw" style="background:#9B59B6" data-c="#9B59B6" onclick="pickC(this)"></div></div></div>
    <div class="fg"><label class="fl">דירוג</label><div class="rrow"><span class="rstar" data-r="1" onclick="pickR(1)">★</span><span class="rstar" data-r="2" onclick="pickR(2)">★</span><span class="rstar" data-r="3" onclick="pickR(3)">★</span><span class="rstar" data-r="4" onclick="pickR(4)">★</span><span class="rstar" data-r="5" onclick="pickR(5)">★</span></div></div>
    <div class="fg"><label class="fl">מאפיינים</label><input class="fi" id="fTraits" placeholder="ריח עז, גבעול ארוך..."></div>
    <div class="fg"><label class="fl">הערות</label><textarea class="ft" id="fNotes" placeholder="תצפיות..."></textarea></div>
    <div class="macts"><button class="mact mact-save" onclick="saveV()">🌱 שמירה</button><button class="mact mact-cancel" onclick="closeM('addModal')">ביטול</button></div>
  </div>
</div>

<!-- BACKUP MODAL -->
<div class="overlay" id="backupModal" onclick="bgc(event,'backupModal')">
  <div class="sheet">
    <div class="sh-handle"></div>
    <div class="sh-title">💾 גיבוי ושחזור</div>
    <div style="display:grid;gap:12px;margin-bottom:20px">
      <button class="mact mact-save" onclick="exportBackup()">📥 ייצא גיבוי (JSON)</button>
      <label class="mact" style="background:var(--leaf);color:white;text-align:center;cursor:pointer">
        📤 שחזר מגיבוי
        <input type="file" accept=".json" onchange="importBackup(event)" style="display:none">
      </label>
      <div style="background:var(--parchment);padding:12px;border-radius:10px;border:1px solid var(--border)">
        <div style="font-size:11px;color:var(--text-soft);margin-bottom:6px;font-weight:700">מידע:</div>
        <div style="font-size:13px;line-height:1.6">הגיבוי שומר את כל הנתונים שלך (כולל תמונות) לקובץ JSON שתוכל לשחזר בכל עת.</div>
      </div>
    </div>
    <button class="mact mact-cancel" onclick="closeM('backupModal')">סגור</button>
  </div>
</div>

<script src="app.js"></script>
</body>
</html>
